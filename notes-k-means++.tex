\documentclass{article}

\usepackage{fullpage,amssymb,amsmath,amsthm}
\usepackage{algorithm,algorithmic}

\newcommand{\R}{\mathbb{R}}
\newcommand{\norm}[1]{\|{#1}\|}

\begin{document}

Given two finite sets $S,C \subset \R^d$ we define the \emph{cost of $C$ on $S$}
as
$$
f(S,C) = \sum_{x \in S} \min_{c \in C} \norm{x-c}^2 \; .
$$

The \emph{$k$-means problem} is the following:
Given a finite set $S \subset \R^d$ and a positive integer $k$, find a set $C \subset \R^d$
such that $|C| \le k$ that minimizes $f(S,C)$.

The $k$-means problem is solved in practice using a local-search heuristic,
called Lloyd's algorithm (or sometimes simply called \emph{the $k$-means
algorithm}).

\begin{algorithm}[h]
\caption{Lloyd's algorithm a.k.a. the $k$-means algorithm
\label{algorithm:lloyd}}
\begin{algorithmic}[1]
{
\STATE{Initialize $c_1, c_2, \dots, c_k \in \R^d$ somehow}
\WHILE{true}
\STATE{For each $i=1,2,\dots,k$, let $C_i$ be the set of points $x \in S$ that are closer
to $c_i$ that to any other $c_j$ for all $j \neq i$.}
\STATE{For each $i=1,2\dots,k$, set $c_i = \frac{1}{|S_i|} \sum_{x \in C_i} x$. If centers have not changed, stop.}
\ENDWHILE
}
\end{algorithmic}
\end{algorithm}

In step $3$ of the algorithm, if a point $x \in S$ is closest to two (or more) different centers,
the algorithm breaks ties arbitrarily. The algorithm does alternating minimization.
This can be seen by defining a cost function
$$
g(c_1, c_2, \dots, c_k; C_1, C_2, \dots, C_k) = \sum_{i=1}^k \sum_{x \in C_k} \norm{x - c_i}^2 \; .
$$
Note that $g(c_1, c_2, \dots, c_k; C_1, C_2, \dots, C_k) \ge f(\bigcup_{i=1}^k C_i, \{c_1, c_2, \dots, c_k\})$
with equality when for all $i$, the center $c_i$ is the center of mass of $C_i$.
In steps $3$, the algorithm keeps $c_1, c_2, \dots, c_k$ and
it finds $(C_1, C_2, \dots, C_k)$ such that $g(c_1, c_2, \dots, c_k; C_1, C_2, \dots, C_k)$
is minimized (subject to the constraint that $C_1, C_2, \dots, C_k$ is a partition of $S$). Similarly, in step $4$,
the algorithm fixes $C_1, C_2, \dots, C_k$ and finds $c_1, c_2, \dots, c_k$ such that

\end{document}
